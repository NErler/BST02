---
title: 'Basic Use of R'
output: 
  html_document:
    code_folding: show
    df_print: paged
    toc: true
    toc_float:
      collapsed: false
    number_sections: false
    theme: spacelab
    highlight: tango
    includes:
      after_body: ../footerEA.html
    css: ../style.css
---

```{r, echo = FALSE, purl = FALSE}
knitr::knit_hooks$set(purl = knitr::hook_purl)

options(purl = FALSE)

knitr::opts_chunk$set(purl = FALSE)
```

```{r, include = FALSE}
knitr::opts_hooks$set(eval = function(opt) {
  if (any(opt$exercise))
    opt$eval <- opt$include <- FALSE
  
  opt
})


static <- TRUE

options(width = 100)

```


```{r packages, include = FALSE}
library(kableExtra)
library(knitr)
```


```{r load_data, context="data", include=FALSE}
library(survival)
```


## Preface {data-progressive=FALSE}
### R packages
In this practical, a number of R packages are used.
The packages used (with versions that were used to generate the solutions) are:

* `r R.version.string`
* `survival` (version: `r packageVersion("survival")`)
* `memisc` (version: `r packageVersion("memisc")`)
* `ggplot2` (version: `r packageVersion("ggplot2")`)


### Dataset {.tabset .tabset-fade .tabset-pills}

For this practical, we will use the **heart** and **retinopathy** data sets from the `survival` package. More details about the data sets can be found in:

https://stat.ethz.ch/R-manual/R-devel/library/survival/html/heart.html

https://stat.ethz.ch/R-manual/R-devel/library/survival/html/retinopathy.html

Always check your data.


```{r, eval = static, echo = FALSE}
asis_output("#### Task\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Explore the **heart** and **retinopathy** data sets - print the first six and last six rows. 

```{r data_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#data">Hint</button>
<div id = "data" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the functions head(...) and tail(...) to investigate the data set. Replace the dots with the name of the data set.
</div>')
```


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution\\n")
```

```{r data-solution, solution = TRUE}
library(survival)
head(heart)
tail(heart)
head(retinopathy)
tail(retinopathy)
```

## Common R Objects

It is important to distinguish the different object in R.

### Vectors {.tabset .tabset-fade .tabset-pills}

Let's investigate some vectors.

```{r, eval = static, echo = FALSE}
asis_output("#### Task 1\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

View the vectors `event` and `age` from the **heart** data set.

```{r vec_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#vec">Hint</button>
<div id = "vec" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the dollar sign to select the variables.
</div>')
```


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 1\\n")
```

```{r vec-solution, solution = TRUE}
heart$event
heart$age
```



```{r, eval = static, echo = FALSE}
asis_output("#### Task 2\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

View the vectors `eye` and `risk` from the **retinopathy** data set.

```{r vec2_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#vec2">Hint</button>
<div id = "vec2" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the dollar sign to select the variables.
</div>')
```


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 2\\n")
```

```{r vec2-solution, solution = TRUE}
retinopathy$eye
retinopathy$risk
```





```{r, eval = static, echo = FALSE}
asis_output("#### Task 3\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Create a numerical vector that consists of the values: 34, 24, 19, 23, 16. Give the name `numbers` to this new vector.

```{r vec3_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#vec3">Hint</button>
<div id = "vec3" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the c(...) function. Replace the dots with the numbers.
</div>')
```


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 3\\n")
```

```{r vec3-solution, solution = TRUE}
numbers <- c(34, 24, 19, 23, 16)
```






```{r, eval = static, echo = FALSE}
asis_output("#### Task 4\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Create a numerical vector that takes the integer values from 1 until 200. Give the name `numbers_2` to this new vector.

```{r vec4_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#vec4">Hint</button>
<div id = "vec4" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the c(...) function. Replace the dots with the numbers.
</div>')
```


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 4\\n")
```

```{r vec4-solution, solution = TRUE}
numbers_2 <- c(1:200)
```






```{r, eval = static, echo = FALSE}
asis_output("#### Task 5\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Create a categorical vector that consists of the values: yes, yes, no, no, no, yes. Give the name `treatment` to this new vector.

```{r vec5_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#vec5">Hint</button>
<div id = "vec5" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the c(...) function. Replace the dots with the categories.
</div>')
```


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 5\\n")
```

```{r vec5-solution, solution = TRUE}
treatment <- c("yes", "yes", "no", "no", "no", "yes")
```



### Matrices and Data Frames {.tabset .tabset-fade .tabset-pills}

Let's investigate some matrices and data frames.

```{r, eval = static, echo = FALSE}
asis_output("#### Task 1\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Create a matrix using the vectors `id` and `age` from the **heart** data set. This matrix should have 2 columns where each column represents each variable.

```{r mat_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#mat">Hint</button>
<div id = "mat" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the function matrix(...).
</div>')
```


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 1\\n")
```

```{r mat-solution-1, solution = TRUE}
matrix(c(heart$id, heart$age), , 2) 
```



```{r, eval = static, echo = FALSE}
asis_output("#### Task 2\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Create a data frame using the vectors `id`, `type` and `trt` from the **retinopathy** data set. This data frame should have 3 columns, where each column represents each variable.

```{r df_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#df">Hint</button>
<div id = "df" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the function data.frame(...).
</div>')
```


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 2\\n")
```

```{r dfc-solution, solution = TRUE}
data.frame(id = retinopathy$id, type = retinopathy$type, trt = retinopathy$trt) 
```



### Lists {.tabset .tabset-fade .tabset-pills}

Let's investigate some lists.

```{r, eval = static, echo = FALSE}
asis_output("#### Task 1\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Create a list using the vectors `stop` from the **heart** data set and `id`, `risk` from the **retinopathy** data set. Give the names `stop_heart`, `id_reti` and `risk_reti`.

```{r list_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#list">Hint</button>
<div id = "list" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the function list(...).
</div>')
```


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 1\\n")
```

```{r list-solution, solution = TRUE}
list(stop_heart = heart$stop, id_retini = retinopathy$id, risk_reti = retinopathy$risk)
```


```{r, eval = static, echo = FALSE}
asis_output("#### Task 2\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Create a list using the vectors `numbers`, `numbers_2` and `treatment`. These variables can be taken from the exercise called `Vectors`.  Give the names: `numbers`, `many_numbers` and `treatment`.

```{r list2_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#list2">Hint</button>
<div id = "list2" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the function list(...).
</div>')
```


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 2\\n")
```

```{r list2-solution, solution = TRUE}
list(numbers = numbers, many_numbers = numbers_2, treatment = treatment)
```



## Importing and Saving data
### Save your work {.tabset .tabset-fade .tabset-pills}

It is important to save your work.

```{r, eval = static, echo = FALSE}
asis_output("#### Task\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Save the vectors `numbers`, `numbers_2` and `treatment`. Use the name `new_vectors`. These variables can be taken from the exercise called `Vectors`.

```{r save_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#save">Hint</button>
<div id = "save" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the function save(...). Note that you need to set the working directory.
</div>')
```


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution\\n")
```

```{r save-solution, solution = TRUE}
save(numbers, numbers_2, treatment, file = "new_vectors.RData")
```


### Load your work {.tabset .tabset-fade .tabset-pills}

Let's continue working on the data sets by loading our results.

```{r, eval = static, echo = FALSE}
asis_output("#### Task\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Load the file `new_vectors`.

```{r load_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#load">Hint</button>
<div id = "load" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the function load(...).
</div>')
```


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution\\n")
```

```{r load-solution, solution = TRUE}
load("new_vectors.RData")
```


### Remove your work {.tabset .tabset-fade .tabset-pills}

Remove unnecessary objects.

```{r, eval = static, echo = FALSE}
asis_output("#### Task\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Remove the vectors `numbers`, `numbers_2` and `treatment`.

```{r rm_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#rm">Hint</button>
<div id = "rm" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the function rm(...).
</div>')
```


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution\\n")
```

```{r rm-solution, solution = TRUE}
rm(numbers, numbers_2, treatment)
```


## Data Manipulation, Exploration and Visualization

Before starting with any statistical analysis it is important to transform and explore your data set.

### Data Manipulation {.tabset .tabset-fade .tabset-pills}


```{r, eval = static, echo = FALSE}
asis_output("#### Task 1\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

* As mentioned in the manual of the **heart** data set, `age` is equal to `age` - 48. Let's bring `age` back to the normal scale. Do not overwrite the variable `age`, but create a new variable with the name `age_orig`. \
* Convert the variable `surgery` into a factor with levels 0: `no` and 1: `yes`.

```{r man1_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#man1">Hint</button>
<div id = "man1" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the function factor(...) to convert a numerical variable to a factor.
</div>')
```

```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 1\\n")
```

```{r man1-solution, solution = TRUE}
heart$age_orig <- heart$age + 48
heart$surgery <- factor(heart$surgery, levels = c(0, 1), labels = c("no", "yes"))
```




```{r, eval = static, echo = FALSE}
asis_output("#### Task 2\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Categorize the variable `age` from the **retinopathy** data set as `young`: [minimum `age` until mean `age`) and `old`: [mean `age` until maximum `age`). Give this variable the name `ageCat`. Print the first 6 rows of the data set **retinopathy**.

```{r man2_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#man2">Hint</button>
<div id = "man2" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
To dichotomize a numerical variable use the function as.numeric(...). Use the function factor(...) to convert a variable into a factor. 
</div>')
```

```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 2\\n")
```

```{r man2-solution, solution = TRUE}
retinopathy$ageCat <- as.numeric(retinopathy$age >= mean(retinopathy$age))
retinopathy$ageCat <- factor(retinopathy$ageCat, levels = c(0, 1), labels = c("young", "old"))
head(retinopathy)
```




```{r, eval = static, echo = FALSE}
asis_output("#### Task 3\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Categorize `futime` from data set **retinopathy** as follows: \

* `short`: [minimum `futime` until 2). \
* `medium`: [25 until 45). \
* `long`: [45 until maximum `futime`). \
Give this variable the name `futimeCat`. Print the first 6 rows of the data.


```{r man3_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#man3">Hint</button>
<div id = "man3" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the function cut(..., right = FALSE) to convert a continuous variable to a categorical variable. If you need help check ?cut. Use the function factor(...) to convert a variable into a factor. 
</div>')
```

```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 3\\n")
```

```{r man3-solution, solution = TRUE}
retinopathy$futimeCat <- cut(retinopathy$futime, c(min(retinopathy$futime), 25, 45, max(retinopathy$futime)), right = FALSE)
retinopathy$futimeCat <- factor(retinopathy$futimeCat, levels = c("[0.3,25)", "[25,45)", "[45,75)"), labels = c("short", "medium", "long"))
head(retinopathy)
```








```{r, eval = static, echo = FALSE}
asis_output("#### Task 4\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Create 2 vectors of size 50 as follows: \

* `Sex`: takes 2 values 0 and 1. \
* `Age`: takes values from 20 till 80. \
* Convert the `Sex` variable into a factor with levels 0: `female` and 1: `male`. \
* Define the new variable `AgeCat` as dichotomous with `Age` <= 50 to be 0 and 1 otherwise. \
* Convert the `AgeCat` variable into a factor with levels 0: `young` and 1: `old`. \
* Overwrite the `Age` variable by $\frac{Age-mean(Age)}{sd(Age)}$.

```{r man4_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#man4">Hint</button>
<div id = "man4" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
To sample a numerical and categorical variable use the function sample(...). To convert a numerical variable to a categorical use the function factor(...). To dichotomize a numerical variable use the function as.numeric(...).
</div>')
```


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 4\\n")
```

```{r man4-solution, solution = TRUE}
Sex <- sample(0:1, 50, replace = T)
Age <- sample(20:80, 50, replace = T)
Sex <- factor(Sex, levels = c(0:1), labels = c("female", "male"))
AgeCat <- as.numeric(Age > 50)
AgeCat <- factor(AgeCat, levels = c(0:1), labels = c("young", "old"))
Age <- (Age - mean(Age))/sd(Age)
```




```{r, eval = static, echo = FALSE}
asis_output("#### Task 5\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Create a data frame with the name `DF` as follows: \

* Include the following vectors: `Sex`, `Age`, `AgeCat` form the previous Task. \
* Use the names: `Gender`, `StandardizedAge`, `DichotomousAge`. \


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 5\\n")
```

```{r man5-solution, solution = TRUE}
DF <- data.frame(Sex, Age, AgeCat)
DF <- data.frame("Gender" = Sex, "StandardizedAge" = Age, "DichotomousAge" = AgeCat)
```


```{r, eval = static, echo = FALSE}
asis_output("#### Task 6\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Create 2 vectors of size 150 as follows: \

* `Treatment`: takes 2 values 1 and 2. \
* `Weight`: takes values from 50 till 100. \
* Convert the `Treatment` variable into a factor with levels 1: `no` and 2: `yes`. \
* Overwrite the `Weight` variable by `Weight` * 1000. \
* Create a data frame including `Treatment` and `Weight`. \

```{r man6_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#man6">Hint</button>
<div id = "man6" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
To sample a numerical and categorical variable use the function sample(...). To convert a numerical variable to a categorical use the function factor(...). 
</div>')
```


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 6\\n")
```

```{r man6-solution, solution = TRUE}
Treatment <- sample(1:2, 150, replace = T)
Weight <- sample(50:100, 150, replace = T)
Treatment <- factor(Treatment, levels = c(1:2), labels = c("no", "yes"))
Weight <- Weight * 1000
data.frame(Treatment, Weight)
```



```{r, eval = static, echo = FALSE}
asis_output("#### Task 7\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Create a list called `my_list` with the following: \

* `let`: `a` to `i`. \
* `sex`: factor taking the values `males` and `females` and length 50. \
* `mat`: matrix 
<TABLE>
   <TR>
      <TD>1 \ \  </TD>
      <TD>2</TD>
   </TR>
   <TR>
      <TD>3 \ \  </TD>
      <TD>4</TD>
   </TR>
</TABLE> 

```{r man7_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#man7">Hint</button>
<div id = "man7" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
To obtain letters use the function letters(...). To sample a numerical and categorical variable use the function sample(...). To convert a numerical variable to a categorical use the function factor(...). 
</div>')
```


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 7\\n")
```

```{r man7-solution, solution = TRUE}
let <- letters[1:9]
sex <- sample(1:2, 50, replace = TRUE)
sex <- factor(sex, levels = 1:2, labels = c("males", "females"))
mat <- matrix(1:4 ,2, 2, byrow = TRUE)
my_list <- list(let = let, sex = sex, mat = mat) 
```


### Data Exploration {.tabset .tabset-fade .tabset-pills}

Let's obtain some descriptive statistics.

```{r, eval = static, echo = FALSE}
asis_output("#### Task 1\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Obtain the mean and standard deviation for the variable `age` using the **heart** data set.

```{r exp1_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#exp1">Hint</button>
<div id = "exp1" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the functions mean(...) and sd(...).
</div>')
```

```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 1\\n")
```

```{r exp1-solution, solution = TRUE}
mean(heart$age)
sd(heart$age)
```



```{r, eval = static, echo = FALSE}
asis_output("#### Task 2\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Using the **retinopathy** data set: \

* Obtain the median and interquartile range for `age`. \ \
* Obtain the percentage per `type`. \
* Check whether there are missing in the variable `age`.

```{r exp2_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#exp2">Hint</button>
<div id = "exp2" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the functions median(...) and IQR(...) to obtain the median and the interquartile range. Load the package memisc and use the function percent(...) in order to obtain the percentages. To check whether there are missing values use the functions sum(is.na(...)).
</div>')
```

```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 2\\n")
```

```{r exp2-solution, solution = TRUE}
median(retinopathy$age)
IQR(retinopathy$age)
library(memisc)
percent(retinopathy$type)
sum(is.na(retinopathy$age)) # any(is.na(retinopathy$age))
```


```{r, eval = static, echo = FALSE}
asis_output("#### Task 3\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Using the data frame `DF` from the exercise before (Task 5): \

* Calculate the mean of the variable `StandardizedAge`. \
* Calculate the standard deviation of the variable `StandardizedAge`. \
* Calculate the frequencies of the variable `Gender`. \
* Calculate the frequencies of the variable `DichotomousAge`. \
* Calculate the frequencies of both variables `Gender` and `DichotomousAge` (crosstab table). \
* What are the dimensions of the data.frame?

```{r exp3_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#exp3">Hint</button>
<div id = "exp3" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
To calculate the frequencies, use the functions length() or table(). To obtain the dimensions use the function dim(...).
</div>')
```

```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 3\\n")
```

```{r exp3-solution, solution = TRUE}
mean(DF$StandardizedAge)
sd(DF$StandardizedAge)
length(DF$Gender[DF$Gender == "female"])
length(DF$Gender[DF$Gender == "male"])
table(DF$Gender)
table(DF$Gender, DF$DichotomousAge)
dim(DF)
```



### Data Visualization {.tabset .tabset-fade .tabset-pills}

Let's visualize the data.

```{r, eval = static, echo = FALSE}
asis_output("#### Task 1\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Using the **heart** data set: \

* Create a scatterplot with the variables `age` and `year`  \
* Change the labels of the axis. In particular, give the name `Age` for the x-axis and `Year of acceptance` for the y-axis. \
* Give a different color to the patients that had a transplant. \
* Add a legend.

```{r plot1_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#plot1">Hint</button>
<div id = "plot1" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the function plot(..., xlab, ylab, col). Use the function legend(...) to add a legend to the plot.
</div>')
```

```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 1\\n")
```

```{r plot1-solution, solution = TRUE}
plot(heart$age, heart$year)
plot(heart$age, heart$year, xlab = "Age", ylab = "Year of acceptance")
plot(heart$age, heart$year, xlab = "Age", ylab = "Year of acceptance", col = heart$transplant)
legend(-40, 6, c("no", "yes"), col = c("black", "red"), pch = 1)
```



```{r, eval = static, echo = FALSE}
asis_output("#### Task 2\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Using the **retinopathy** data set: \

* Create a boxplot of `age` per `status`.\
* Change the colour to blue and green respectively.

```{r plot2_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#plot2">Hint</button>
<div id = "plot2" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the function boxplot(...). 
</div>')
```

```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 2\\n")
```

```{r plot2-solution, solution = TRUE}
boxplot(retinopathy$age ~ retinopathy$status)
boxplot(retinopathy$age ~ retinopathy$status, col = c("blue", "green"))
```


```{r, eval = static, echo = FALSE}
asis_output("#### Task 3\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Using the **retinopathy** data set: \

* Create a smooth plot of `age` with `risk`. \
* Create a density plot of `age` per `type` group.

```{r plot3_hint, eval = static, results = 'asis', echo = FALSE}
cat('<button type="button" class="btn btn-info btn-sm" data-toggle="collapse" data-target="#plot3">Hint</button>
<div id = "plot3" class="collapse" style="border:1px; border-style:solid; padding: 1em; border-color:#1F78B4">
Use the ggplot2 package and the functions: geom_smooth(...) and geom_density(...).
</div>')
```

```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 3\\n")
```

```{r plot3-solution, solution = TRUE}
library(ggplot2)
ggplot(retinopathy, aes(age, risk)) +
geom_smooth(colour='black', span = 0.4)
ggplot(retinopathy, aes(age, fill = type)) +
geom_density(alpha = 0.25) 
```


## Indexing and Subsetting

Sometimes we want to obtain a subset of the data sets before investigating the descriptive statistics and performing the statistical analysis.

### Indexing {.tabset .tabset-fade .tabset-pills}

```{r, eval = static, echo = FALSE}
asis_output("#### Task\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Using the **heart** data set: \

* Select the first row. \
* Select the first column. \
* Select the column `surgery`.


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution\\n")
```

```{r ind1-solution, solution = TRUE}
heart[1, ]
heart[, 1]
heart["surgery"]
heart[["surgery"]]
heart[, "surgery"]
```


### Subsetting {.tabset .tabset-fade .tabset-pills}

```{r, eval = static, echo = FALSE}
asis_output("#### Task 1\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Using the **retinopathy** data set: \

* Select the `futime` for all `adult` patients. \
* Select all the variables for patients that received treatment. \



```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 1\\n")
```

```{r sub1-solution, solution = TRUE}
retinopathy$futime[retinopathy$type == "adult"]
retinopathy[retinopathy$trt == 1, ]
```


```{r, eval = static, echo = FALSE}
asis_output("#### Task 2\\n")
```

```{r, eval = static, echo = FALSE}
asis_output('<div style="border:2px; border-style:solid; padding: 1em; border-color:#446E9B">')
```

Using the **retinopathy** data set: \

* Select the `age` for patients that have `futime` more than 20. \
* Select the `age` for patients that have `futime` more than 20 and are adults. \
* Select patients that have no missing values in age.


```{r, eval = static, echo = FALSE}
asis_output("</div>")

asis_output("#### Solution 2\\n")
```

```{r sub2-solution, solution = TRUE}
retinopathy$age[retinopathy$futime > 20]
retinopathy$age[retinopathy$futime > 20 & retinopathy$type == "adult"]
retinopathy[!is.na(retinopathy$age), ]
```

